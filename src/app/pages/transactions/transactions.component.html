<div class="mb-2">
  <h1>Transacciones</h1>
</div>

<!-- buscador -->
<form
  autocomplete="off"
  (ngSubmit)="transactionsFilter()"
  [formGroup]="searchTransactionForm"
  class="m-0 p-0 w-100"
>

  <div class="mb-2 d-flex flex-row" *ngIf="valueFilter">

    <div class="collapse dont-collapse-sm mr-3" id="displayOptionsOrigin">
      <div class="d-block d-md-inline-block">
        <label for="searchAdviser">Filtar por origen</label>
        <div class="search-sm d-inline-blockfloat-md-left mr-1 mb-1 align-top">
          <input class="form-control"
                 placeholder="origen"
                 formControlName="originId"
                 [matAutocomplete]="originComplete"
                 id="searchOrigin">
          <mat-autocomplete
            #originComplete="matAutocomplete"
            [displayWith]="showOrigins"
          >
            <mat-option *ngFor="let origin of origins" [value]="origin">
              {{  origin.name | lowercase }}
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
    </div>

    <div class="collapse dont-collapse-sm w-25 mr-3" id="displayOptionsAdviser">
      <div class="d-block d-md-inline-block w-100">
        <label for="searchAdviser">Filtar por asesor</label>
        <div class="search-sm d-inline-block w-100 float-md-left mr-1 mb-1 align-top">
          <input class="form-control w-100"
                 placeholder="asesor"
                 formControlName="adviserId"
                 [matAutocomplete]="adviserComplete"
                 id="searchAdviser">
          <mat-autocomplete
            #adviserComplete="matAutocomplete"
            [displayWith]="showAdvisers"
          >
            <mat-option *ngFor="let adviser of advisers" [value]="adviser">
              {{  adviser.name | lowercase }}
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
    </div>

    <div class="collapse dont-collapse-sm w-25 mr-3" id="displayOptionsUser">
      <div class="d-block d-md-inline-block w-100">
        <label for="dateFinal">Filtar por usuario</label>
        <div class="search-sm d-inline-block w-100 float-md-left mr-1 mb-1 align-top">
          <input class="form-control w-100"
                 placeholder="usuario"
                 formControlName="userId"
                 [matAutocomplete]="UserComplete"
                 id="searchUser">
          <mat-autocomplete
            #UserComplete="matAutocomplete"
            [displayWith]="showUsers"
          >
            <mat-option *ngFor="let user of users" [value]="user">
              {{ user.document_number }} {{ user.name | lowercase }}
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
    </div>

    <div class="collapse dont-collapse-sm mr-3" id="displayDateInitial">
      <div class="d-block d-md-inline-block">
        <div class="d-inline-block float-md-left mr-1 mb-1 align-top">
          <label for="dateInitial">Fecha de inicio</label>
          <input
            type="date"
            class="form-control"
            id="dateInitial"
            formControlName="dateInitial"
          />
        </div>
      </div>
    </div>

    <div class="collapse dont-collapse-sm mr-3" id="displayDateFinal">
      <div class="d-block d-md-inline-block">
        <div class="d-inline-block float-md-left mr-1 mb-1 align-top">
          <label for="dateFinal">Fecha final</label>
          <input
            type="date"
            class="form-control"
            id="dateFinal"
            formControlName="dateFinal"
          />
        </div>
      </div>
    </div>

  </div>

  <div class="mb-2 d-flex flex-row" *ngIf="valueFilter">

    <div class="collapse dont-collapse-sm w-25 mr-3" id="displayOptionsAccount">
      <div class="d-block d-md-inline-block w-100">
        <label for="dateFinal">Filtar por cuenta</label>
        <div class="search-sm d-inline-block w-100 float-md-left mr-1 mb-1 align-top">
          <input class="form-control w-100"
                 placeholder="cuenta"
                 formControlName="accountId"
                 [matAutocomplete]="accountComplete"
                 id="searchAccount">
          <mat-autocomplete
            #accountComplete="matAutocomplete"
            [displayWith]="showAccounts"
          >
            <mat-option *ngFor="let account of accounts" [value]="account">
              {{  account.account_number }} {{ account.name | lowercase }}
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
    </div>

    <div class="collapse dont-collapse-sm w-25 mr-3" id="displayOptionsClient">
      <div class="d-block d-md-inline-block w-100">
        <label for="dateFinal">Filtar por cliente</label>
        <div class="search-sm d-inline-block w-100 float-md-left mr-1 mb-1 align-top">
          <input class="form-control w-100"
                 placeholder="cliente"
                 formControlName="clientId"
                 [matAutocomplete]="clientComplete"
                 id="searchClient">
          <mat-autocomplete
            #clientComplete="matAutocomplete"
            [displayWith]="showDebtorCodebtors"
          >
            <mat-option *ngFor="let client of clients" [value]="client">
              {{ client.document_number }} {{ client.name | lowercase }}
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
    </div>

    <div class="collapse dont-collapse-sm w-25 mr-3" id="displayOptionsCredit">
      <div class="d-block d-md-inline-block w-100">
        <label for="dateFinal">Filtar por crédito</label>
        <div class="search-sm d-inline-block w-100 float-md-left mr-1 mb-1 align-top">
          <input class="form-control w-100"
                 placeholder="codigo del crédito"
                 formControlName="creditId"
                 [matAutocomplete]="creditComplete"
                 id="searchDebtor">
          <mat-autocomplete
            #creditComplete="matAutocomplete"
            [displayWith]="showCredits"
          >
            <mat-option *ngFor="let credit of credits" [value]="credit">
              {{ credit.code | lowercase }}
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
    </div>

    <div class="collapse dont-collapse-sm w-25 mr-3" id="displayOptionsProcess">
      <div class="d-block d-md-inline-block w-100">
        <label for="dateFinal">Filtar por procesos</label>
        <div class="search-sm d-inline-block w-100 float-md-left mr-1 mb-1 align-top">
          <input class="form-control w-100"
                 placeholder="codigo del proceso"
                 formControlName="processId"
                 [matAutocomplete]="processComplete"
                 id="searchProcess">
          <mat-autocomplete
            #processComplete="matAutocomplete"
            [displayWith]="showProcesses"
          >
            <mat-option *ngFor="let process of processes" [value]="process">
              {{ process.code | lowercase }}
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
    </div>

  </div>

  <div class="my-4 d-flex flex-row justify-content-between">

    <div class="d-flex flex-row">

      <div class="collapse d-flex flex-column mr-3" id="displayOptionsItems">
        <div class="d-block d-md-inline-block">
          <div class="btn-group float-md-left mr-1 mb-1">
            <button class="btn btn-outline-dark btn-xs dropdown-toggle"
                    type="button" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">
              {{max}} items
            </button>
            <ul class="dropdown-menu">
              <li class="dropdown-item" (click)="setItems(5)">5 items</li>
              <li class="dropdown-item" (click)="setItems(10)">10 items</li>
              <li class="dropdown-item" (click)="setItems(25)">25 items</li>
              <li class="dropdown-item" (click)="setItems(50)">50 items</li>
              <li class="dropdown-item" (click)="setItems(100)">100 items</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="form-row mr-3" *ngIf="valueFilter">
        <button
          type="submit"
          class="btn btn-primary d-block btn-xs"
        >
          Filtrar transacciones
        </button>
      </div>

      <div class="form-row mr-3" *ngIf="valueFilter">
        <button
          type="button"
          [routerLink]="'/transactions'"
          (click)="cleanFilter(page)"
          class="btn btn-outline-primary d-block btn-xs"
        >
          Limpiar filtros
        </button>
      </div>

      <div class="form-row mr-3">
        <button
          (click)="valueFilter = !valueFilter"
          type="button"
          class="btn btn-primary d-block btn-xs"
        >
          {{valueFilter ? 'Ocultar filtros' : 'Ver filtros'}}
        </button>
      </div>

    </div>

    <div class="d-flex flex-row">

      <div class="form-row mx-3">
        <button
          (click)="getReport()"
          [disabled]="pdfLoading"
          type="button"
          class="btn btn-danger d-block btn-xs"
        >
          {{pdfText}}
        </button>
      </div>

      <div class="form-row">
        <button
          (click)="getReport('excel')"
          [disabled]="excelLoading"
          type="button"
          class="btn btn-success d-block btn-xs"
        >
          {{excelText}}
        </button>
      </div>
    </div>

  </div>

</form>
<!-- fin buscador -->

<div class="separator mb-5"></div>

<div class="row mb-4">
  <app-table-transactions
    (pageChange)="onPageChange($event)"
    [ngClass]="'col-12 mb-4'"
    [title]="'Transacciones'" [items]="transactions"
    [idPg]="'pg-transactions'"
    [totalPaginate]="total"
    [max]="max" [commentary]="true"
    [pagination]="true"></app-table-transactions>
</div>
